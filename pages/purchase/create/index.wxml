<view class="page purchase-create">
  <view class="nav-bar" style="height: {{navBarHeight}}px; padding-top: {{statusBarHeight}}px">
    <view class="back-area" bindtap="goBack">
      <view class="back-icon">‹</view>
    </view>
    <view class="title">录入购卡</view>
    <view class="right-area"></view>
  </view>

  <scroll-view scroll-y class="page-scroll" style="padding-top: {{navBarHeight}}px">
    <view class="form">
      <view class="form-section">
        <view class="form-item">
          <view class="label">归属门店</view>
          <picker mode="selector" range="{{storeOptions}}" range-key="name" value="{{storeIndex}}" bindchange="onStoreChange">
            <view class="picker-control">{{form.storeName || '请选择门店'}}</view>
          </picker>
        </view>
        <view class="form-item">
          <view class="label">购卡顾客</view>
          <picker mode="selector" range="{{customerOptions}}" range-key="name" value="{{customerIndex}}" bindchange="onCustomerChange">
            <view class="picker-control">{{form.customerName || '请选择顾客'}}</view>
          </picker>
        </view>
        <view class="form-item">
          <view class="label">项目/产品</view>
          <picker mode="selector" range="{{productOptions}}" range-key="name" value="{{productIndex}}" bindchange="onProductChange">
            <view class="picker-control">{{form.productName || '请选择项目'}}</view>
          </picker>
        </view>
        <view class="form-item">
          <view class="label">服务人员</view>
          <picker mode="selector" range="{{staffOptions}}" range-key="name" value="{{staffIndex}}" bindchange="onStaffChange">
            <view class="picker-control">{{form.staffName || '请选择服务人员'}}</view>
          </picker>
        </view>
        <view class="form-item">
          <view class="label">实收金额</view>
          <input class="input-control" type="digit" placeholder="请输入金额" value="{{form.amountPaid}}" bindinput="onAmountInput" />
        </view>
        <view class="form-item">
          <view class="label">收款方式</view>
          <picker mode="selector" range="{{payMethodOptions}}" range-key="name" value="{{payMethodIndex}}" bindchange="onPayMethodChange">
            <view class="picker-control">{{payMethodIndex >= 0 ? payMethodOptions[payMethodIndex].name : '请选择方式'}}</view>
          </picker>
        </view>
      </view>

      <view class="form-section">
        <view class="form-item">
          <view class="label">备注</view>
          <textarea class="textarea-control" placeholder="可记录付款细节、优惠信息等" value="{{form.remark}}" bindinput="onRemarkInput"></textarea>
        </view>
      </view>
    </view>
  </scroll-view>

  <view class="submit-area">
    <button class="action-button" loading="{{submitting}}" disabled="{{submitting}}" bindtap="submit">确认保存</button>
  </view>
</view>
